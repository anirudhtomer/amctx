*Setting & Aim*

  - Setting: The setting of the simulation study is motivated by the Aortic Valve
   dataset. We assume that patients undergo a valve transplantation and we follow
   their progression after this operation using the longitudinal outcome (aortic
   gradient). The aim is to effectively plan re-operations. Without loss of
   generality, we assume that the patient population is homogeneous and hence the
   decision of the cardiologists to request a re-operation is solely based on the
   aortic gradient levels and how these are translated to re-operation-free
   survival probabilities. In addition, we assume that at any particular
   follow-up time t, the cardiologist will request a re-operation if the
   conditional survival probability pi_j(t + 2 | t) (i.e., the probability of
   surviving two years after the last echo that was done at time point t) is
   lower than a threshold kappa (e.g., kappa = 0.8).

  - Goal: Follow each patient efficiently and effectively, and request
  re-operation as soon as pi_j(t + 2 | t) < kappa.

*Design*

1. Simulate data from a joint model for n_1 (training data set; \mathcal D_n in
the notation of the paper) and n_2 (test data set). For the subjects in the
test data set, we only simulate a baseline measurement and we keep their
corresponding random effects values.

2. Fit the joint model in the training data set.

3. Calculate pi_j(2 | t = 0) for all patients in the test data set and exclude
those patients for whom pi_j(2 | t = 0) < kappa (i.e., for those patients the
cardiologists will request re-operation without requiring an extra measurements
-- perhaps this is not logical, e.g., better assume that everybody has at least
one measurement after the first surgery?).

4. In general, using the available longitudinal measurements up to any
particular time point t, we will consider two strategies for planning the next
visit of each subject in the test dataset at u > t, namely,

  * S1: Fixed every two years.

  * S2: Based on our method with the constraint pi_j(u | t) < kappa, and
  t^{max} = 2 years.

  4.1 Let u_s denote the time point of the next visit based on strategy s (s = 1,
  2).

  4.2 For the remaining patients, and for each of the two strategies simulate
  longitudinal responses at u_s using the true values of the parameters and the
  true values of the random effects of these patients (so we have longitudinal
  responses under the true data generating mechanism).

  4.2 Calculate pi_j(u_s + 2 | u_s) also using the newly simulated longitudinal
  outcome at u_s, and check if these are lower than kappa.

    - If yes, then select u_s as the final time point for strategy s.

    - If no, then return to 4.1, calculate again u_s while also utilizing the
    simulated longitudinal response(s) at u_s, and simulate new longitudinal
    responses at u_s'.

    - Check again whether pi_j(u_s' + 2 | u_s') < kappa. If yes, the select u_s'
    and otherwise return to 4.1, and so-on.
